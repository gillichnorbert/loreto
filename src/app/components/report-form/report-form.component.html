<div class="card" role="main" aria-labelledby="pageTitle">
  <header>
    <h1 id="pageTitle">DEVOLUCIONES GRUPO ETICALIDAD</h1>
  </header>

  <form [formGroup]="reportForm" (ngSubmit)="onSave()">
    <div class="full">
      <label for="id">ID interno</label>
      <input id="id" type="text" formControlName="id">
    </div>

    <div>
      <label for="client">Cliente / Comprador</label>
      <input id="client" type="text" placeholder="Nombre o ID del cliente" formControlName="client">
    </div>

    <div>
      <label for="orderNumber">NÃºmero de pedido</label>
      <input id="orderNumber" type="text" placeholder="Ingrese el nÃºmero de pedido" formControlName="orderNumber">
    </div>

    <div>
      <label for="brand">Marca</label>
      <select id="brand" formControlName="brand">
        <option value="">Seleccione una marca</option>
        <option value="Renault/Dacia">Renault / Dacia</option>
        <option value="Stellantis">Stellantis</option>
        <option value="Nissan">Nissan</option>
        <option value="Kia">Kia</option>
        <option value="MG">MG</option>
        <option value="Omoda">Omoda</option>
        <option value="Jaecoo">Jaecoo</option>
      </select>
    </div>

    <div>
      <label for="part">Pieza</label>
      <input id="part" type="text" placeholder="Nombre o nÃºmero de pieza" formControlName="part">
    </div>

    <div>
      <label for="reason">Motivo de devoluciÃ³n</label>
      <select id="reason" formControlName="reason">
        <option value="">Seleccione el motivo</option>
        <option value="Calidad">Calidad</option>
        <option value="GarantÃ­a">GarantÃ­a</option>
        <option value="Casco / ProvisiÃ³n">Casco / ProvisiÃ³n</option>
      </select>
    </div>

    <div>
      <label for="status">Estado</label>
      <select id="status" formControlName="status">
        <option value="">Seleccione el estado</option>
        <option value="Enviado a fÃ¡brica">Enviado a fÃ¡brica</option>
        <option value="Pagado">Pagado</option>
        <option value="Rechazado">Rechazado</option>
      </select>
    </div>

    <div class="full">
      <label for="comment">Comentario interno</label>
      <textarea id="comment" placeholder="Notas internas..." formControlName="comment"></textarea>
    </div>

    <div class="actions full">
      <button type="button" (click)="onSave()" class="btn">ğŸ’¾ Guardar reporte</button>
      <button type="button" (click)="onExportCSV()" class="btn ghost">ğŸ“ Exportar a Excel</button>
      <button type="button" (click)="onImportClick()" class="btn ghost">ğŸ“‚ Importar CSV/XLSX</button>
      <button type="button" (click)="onArchive()" class="btn ghost">ğŸ—„ï¸ Archivado automÃ¡tico</button>
      <button type="button" (click)="onClearAll()" class="btn ghost">ğŸ§¹ Borrar todo</button>
      <button type="button" (click)="onDelete()" class="btn ghost">âŒ Borrar seleccionado</button>

      <button type="button" (click)="onExportSelectedPDF()" class="btn ghost">ğŸ“„ Exportar reporte seleccionado (PDF)</button>
      <button type="button" (click)="onExportAllPDF()" class="btn ghost">ğŸ“š Exportar todos los reportes (PDF)</button>

      <div class="report-count">
        ğŸ“Š {{ (reports$ | async)?.length || 0 }} reportes
      </div>
    </div>

    <div class="full">
      <label for="selectReport">Seleccionar reporte existente</label>
      <select id="selectReport" [value]="selectedReportId" (change)="onReportSelected($event)">
        <option value="">-- Ninguno --</option>
        <option *ngFor="let report of (reports$ | async)" [value]="report.id">
          {{ report.id }} â€” {{ report.orderNumber || 'sin pedido' }}
        </option>
      </select>
    </div>
  </form>
</div>

<input 
  type="file" 
  #fileInput 
  (change)="onFileSelected($event)"
  accept=".csv,.xlsx,.xls,.txt" 
  style="display:none"
>